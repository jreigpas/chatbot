(this.webpackJsonpchatbot=this.webpackJsonpchatbot||[]).push([[0],{11:function(e,t,a){e.exports={ChatFooter:"ChatFooter_ChatFooter__3taMf",InputEnabled:"ChatFooter_InputEnabled__1oU-U",ChatFooterButton:"ChatFooter_ChatFooterButton__2Gb-W",ChatFooterModeKeyboard:"ChatFooter_ChatFooterModeKeyboard__3cvDb",inputFile:"ChatFooter_inputFile__1xHmT",SendButton:"ChatFooter_SendButton__R_uI0",ClassLabel:"ChatFooter_ClassLabel__nS87U",ChatFooterModeVoice:"ChatFooter_ChatFooterModeVoice__51P28",ChatFooterVisualizerWrapper:"ChatFooter_ChatFooterVisualizerWrapper__3rcT2",ChatFooterRecognitionWrapper:"ChatFooter_ChatFooterRecognitionWrapper__FXYQx",ChatFooterKeyboardButton:"ChatFooter_ChatFooterKeyboardButton__3iZqy",LoadingButton:"ChatFooter_LoadingButton__2nm4B",Input:"ChatFooter_Input__21WJy",RecordButton:"ChatFooter_RecordButton__1gDaZ",wave:"ChatFooter_wave__dGA2X",items:"ChatFooter_items__2sK7L"}},116:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a(1),r=a.n(o),i=a(29),s=a.n(i),c=(a(77),a(2)),l=a(13);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function d(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var b=o.createElement("path",{d:"M443.6,387.1L312.4,255.4l131.5-130c5.4-5.4,5.4-14.2,0-19.6l-37.4-37.6c-2.6-2.6-6.1-4-9.8-4c-3.7,0-7.2,1.5-9.8,4  L256,197.8L124.9,68.3c-2.6-2.6-6.1-4-9.8-4c-3.7,0-7.2,1.5-9.8,4L68,105.9c-5.4,5.4-5.4,14.2,0,19.6l131.5,130L68.4,387.1  c-2.6,2.6-4.1,6.1-4.1,9.8c0,3.7,1.4,7.2,4.1,9.8l37.4,37.6c2.7,2.7,6.2,4.1,9.8,4.1c3.5,0,7.1-1.3,9.8-4.1L256,313.1l130.7,131.1  c2.7,2.7,6.2,4.1,9.8,4.1c3.5,0,7.1-1.3,9.8-4.1l37.4-37.6c2.6-2.6,4.1-6.1,4.1-9.8C447.7,393.2,446.2,389.7,443.6,387.1z"});function p(e,t){var a=e.title,n=e.titleId,r=d(e,["title","titleId"]);return o.createElement("svg",u({fill:"#CC3300",height:"20px",id:"Layer_1",viewBox:"0 0 512 512",width:"20px",xmlSpace:"preserve",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",ref:t,"aria-labelledby":n},r),a?o.createElement("title",{id:n},a):null,b)}var h=o.forwardRef(p),g=(a.p,a.p+"static/media/widget-img.2c07071b.png"),f=a(34),j=a.n(f),v=a(60),m=(a(41),function(e){var t=Object(v.a)("global").t,a=Object(o.useState)(!0),i=Object(c.a)(a,2),s=i[0],l=i[1],u=function(t){l(!0),e.click(t)};var d="";return e.show&&(d=Object(n.jsxs)("div",{className:j.a.WidgetButtonContainer,role:"region","aria-label":t("widget.title"),children:[Object(n.jsx)("button",{id:"cbWidgetButton",className:j.a.WidgetButton,onClick:function(){return u("chat")},title:t("widget.button.title"),"aria-label":t("widget.button.title"),children:Object(n.jsx)("img",{src:g,alt:"Open ChatBot"})}),Object(n.jsx)("button",{id:"cbWidgetSmallButton",tabIndex:"0",className:j.a.CloseButton,onClick:function(){return u("smallButton")},title:t("widget.bubble.close"),"aria-label":t("widget.bubble.close"),children:Object(n.jsx)(h,{})})]})),Object(n.jsx)(r.a.Fragment,{children:d})}),O=a.p+"static/media/widget-img-small.5235a67e.png",_=a(42),x=a.n(_),C=a(35),y=a.n(C),w=function(e){var t=Object(v.a)("global").t;return Object(n.jsx)(r.a.Fragment,{children:Object(n.jsxs)("div",{className:y.a.BubbleContainer,role:"region","aria-label":t("widget.bubble.title"),children:[Object(n.jsxs)("button",{tabIndex:"0",className:y.a.Bubble,onClick:e.click,children:[Object(n.jsx)("span",{dangerouslySetInnerHTML:{__html:t("widget.bubble.text1")}}),Object(n.jsx)("span",{dangerouslySetInnerHTML:{__html:t("widget.bubble.text2")}})]}),Object(n.jsx)("button",{tabIndex:"0",className:y.a.CloseButton,onClick:function(t){t.stopPropagation(),e.close()},title:t("widget.bubble.close"),"aria-label":t("widget.bubble.close"),children:Object(n.jsx)(h,{})})]})})},S=function(e){var t=Object(v.a)("global").t,a=Object(o.useState)(!0),i=Object(c.a)(a,2),s=i[0],l=i[1],u="";s&&(u=Object(n.jsx)(w,{close:function(){l(!1)}}));var d="";return e.show&&(d=Object(n.jsxs)("div",{className:x.a.WidgetSmall,role:"region","aria-label":t("widget.title"),children:[u,Object(n.jsx)("button",{id:"cbWidgetSmallButton2",className:x.a.WidgetButtonSmall,onClick:function(){return t="bigButton",l(!0),void e.click(t);var t},title:t("widget.button.title"),"aria-label":t("widget.button.title"),children:Object(n.jsx)("img",{src:O,alt:"Open ChatBot"})})]})),Object(n.jsx)(r.a.Fragment,{children:d})},k=a(5),I=a(63),B=a.n(I),M=a(19),N=a(18),E=a(4),L=function e(t,a,n){Object(E.a)(this,e),this.type=t,this.fromUser=a||!1,this.payload=n},T=function(e){Object(M.a)(a,e);var t=Object(N.a)(a);function a(e){var n,o=e.fromUser,r=e.text,i=e.agentChat,s=e.now;return Object(E.a)(this,a),(n=t.call(this)).type="text",n.fromUser=o,n.payload={text:r},n.agentChat=i,n.now=s,n}return a}(L),D=function e(t){var a=t.title,n=t.value,o=t.action,r=t.type;Object(E.a)(this,e),this.title=a,this.value=n,this.action=o,this.type=r},F=function(e){Object(M.a)(a,e);var t=Object(N.a)(a);function a(e){var n,o=e.buttons,r=e.downloads,i=e.position;return Object(E.a)(this,a),(n=t.call(this)).position=i,n.type="quick_reply",n.payload={buttons:o,downloads:r},n}return a}(L),A=function(e){Object(M.a)(a,e);var t=Object(N.a)(a);function a(e){var n,o=e.items;return Object(E.a)(this,a),(n=t.call(this)).type="CARRUSEL",n.payload={items:o},n}return a}(L),R=a(16),U=a.n(R);function V(){return(V=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function W(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var z=o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M10 6H22C24.2091 6 26 7.79086 26 10V22C26 24.2091 24.2091 26 22 26H10C7.79086 26 6 24.2091 6 22V10C6 7.79086 7.79086 6 10 6ZM4 10C4 6.68629 6.68629 4 10 4H22C25.3137 4 28 6.68629 28 10V22C28 25.3137 25.3137 28 22 28H10C6.68629 28 4 25.3137 4 22V10ZM10 21C9.44772 21 9 21.4477 9 22C9 22.5523 9.44772 23 10 23H22C22.5523 23 23 22.5523 23 22C23 21.4477 22.5523 21 22 21H10Z",fill:"white"});function P(e,t){var a=e.title,n=e.titleId,r=W(e,["title","titleId"]);return o.createElement("svg",V({width:32,height:32,viewBox:"0 0 32 32",fill:"none","aria-hidden":"true",focusable:"false",ref:t,"aria-labelledby":n},r),a?o.createElement("title",{id:n},a):null,z)}var H=o.forwardRef(P),q=(a.p,function(e){var t=Object(v.a)("global").t;return Object(n.jsxs)("div",{className:U.a.ChatHeader,role:"region","aria-label":t("chatheader.title"),children:[Object(n.jsxs)("div",{className:U.a.HeaderAndLogo,children:[Object(n.jsx)("img",{src:g,alt:"Open ChatBot",className:U.a.Logo}),Object(n.jsx)("div",{className:U.a.Title,children:"LineaMadrid"})]}),Object(n.jsx)("div",{className:U.a.MoveAndCloseIcon,children:Object(n.jsx)("button",{className:U.a.CloseButton,onClick:function(){return t="chat",void e.close(t);var t},title:t("chatheader.close"),"aria-label":t("chatheader.close"),children:Object(n.jsx)(H,{})})})]})}),K=a(43),J=a.n(K),G=a(21),Z=a.n(G),Q=function(e){return Object(n.jsx)("div",{className:Z.a.Spinner,children:Object(n.jsxs)("div",{className:Z.a.DotContainer,children:[Object(n.jsx)("div",{className:Z.a.Dot}),Object(n.jsx)("div",{className:Z.a.Dot}),Object(n.jsx)("div",{className:Z.a.Dot})]})})},X=a(22),Y=a.n(X),$=function(e){var t=[Y.a["".concat(e.origin,"-message")],Y.a.TextMessage,Y.a.imageAvatar];return Object(n.jsx)(n.Fragment,{children:!e.fromUser&&e.agentChat?Object(n.jsx)("div",{children:Object(n.jsxs)("div",{className:Y.a.WithAvatar,children:[Object(n.jsx)("img",{className:Y.a.ImgAvatar,src:"iconoAvatar.jpeg",alt:"Person"}),Object(n.jsxs)("div",{children:[Object(n.jsx)("div",{className:t.join(" "),style:e.style,children:Object(n.jsx)("span",{dangerouslySetInnerHTML:{__html:e.payload.text}})}),Object(n.jsxs)("small",{children:[e.now,e.fromUser]})]})]})}):Object(n.jsx)("div",{className:t.join(" "),style:e.style,children:Object(n.jsx)("span",{dangerouslySetInnerHTML:{__html:e.payload.text}})})})},ee=a(36),te=a.n(ee),ae=a(25),ne=a.n(ae),oe=function(e){var t=Object(o.useState)(!1),a=Object(c.a)(t,2),r=(a[0],a[1],function(){"URL"===e.type&&"GET_LOCATION"===e.action?e.getClick(e.action,e.title):"URL"===e.type?window.open(e.value,"URL"===e.type?"_blank":"_self"):e.value&&e.getClick(e.value,e.title)}),i=[];return i="disabled"===e.type?[ne.a.Button,ne.a.Disabled]:[ne.a.Button,"quick_reply"===e.type?ne.a.Secondary:""],Object(n.jsx)("button",{type:"button",style:e.style,onKeyPress:function(e){13===e.charCode&&r()},className:i.join(" "),disabled:e.isDisabled,onClick:r,children:Object(n.jsx)("span",{children:e.title})})},re=function(e){var t=[te.a["".concat(e.origin,"-message")],te.a.QuickReply];e.payload.buttons.length>2&&t.push(te.a.VerticalButtons);var a=e.payload.buttons.map((function(t,a){return Object(n.jsx)("li",{children:Object(n.jsx)(oe,{title:t.title,value:t.value,action:t.action,type:t.type,click:e.selected,style:e.buttonStyle,getClick:e.getClick},a)},a)}));return Object(n.jsx)("div",{className:t.join(" "),style:e.style,children:a})},ie=a(17),se=a.n(ie),ce=function(e){var t=e.children,a=Object(o.useState)(0),r=Object(c.a)(a,2),i=r[0],s=r[1],l=Object(o.useState)(t.length),u=Object(c.a)(l,2),d=u[0],b=u[1];Object(o.useEffect)((function(){b(t.length)}),[t]);return Object(n.jsx)("div",{className:se.a.carouselContainer,children:Object(n.jsxs)("div",{className:se.a.carouselWrapper,children:[i>0&&Object(n.jsx)("button",{onClick:function(){i>0&&s((function(e){return e-1}))},className:se.a.leftArrow,children:Object(n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",role:"img","aria-label":"Previous card",children:Object(n.jsx)("path",{d:"M16 17.65L14.261 19 8 12l6.261-7L16 6.35 10.946 12z"})})}),Object(n.jsx)("div",{className:se.a.carouselContentWrapper,children:Object(n.jsx)("div",{className:se.a.carouselContent,style:{transform:"translateX(-".concat(100*i,"%)")},children:t})}),i<d-1&&Object(n.jsx)("button",{onClick:function(){i<d-1&&s((function(e){return e+1}))},className:se.a.rightArrow,children:Object(n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",role:"img","aria-label":"Next card",children:Object(n.jsx)("path",{d:"M8 17.65L9.739 19 16 12 9.739 5 8 6.35 13.054 12z"})})})]})})},le=a(12),ue=a.n(le),de=a(44),be=a.n(de);function pe(){return(pe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function he(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var ge=o.createElement("path",{d:"M12 15L16 11M12 15V3V15ZM12 15L8 11L12 15Z",stroke:"#C33400",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"}),fe=o.createElement("path",{d:"M2 17L2.621 19.485C2.72915 19.9177 2.97882 20.3018 3.33033 20.5763C3.68184 20.8508 4.11501 20.9999 4.561 21H19.439C19.885 20.9999 20.3182 20.8508 20.6697 20.5763C21.0212 20.3018 21.2708 19.9177 21.379 19.485L22 17",stroke:"#C33400",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"});function je(e,t){var a=e.title,n=e.titleId,r=he(e,["title","titleId"]);return o.createElement("svg",pe({viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",focusable:"false",ref:t,"aria-labelledby":n},r),a?o.createElement("title",{id:n},a):null,ge,fe)}var ve=o.forwardRef(je),me=(a.p,a(10)),Oe=a.n(me),_e=function(e){var t=Object(o.useState)(!1),a=Object(c.a)(t,2),r=(a[0],a[1]),i=[be.a.Download,be.a["Download--".concat(e.type)]];return Object(n.jsxs)("button",{type:"button",style:e.style,className:i.join(" "),disabled:e.isDisabled,onClick:function(){r(!0),Oe()({url:e.url,method:"GET",responseType:"blob"}).then((function(t){var a=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=a,n.setAttribute("download",e.file),document.body.appendChild(n),n.click(),n.parentNode.removeChild(n),e.click(e.downloadOk,e.title)})).catch((function(t){e.click(e.downloadKo,e.title)}))},children:[Object(n.jsx)(ve,{}),Object(n.jsx)("span",{children:e.title})]})},xe=function(e){var t=Object(v.a)("global").t,a=[ue.a["".concat(e.origin,"-message")],ue.a.Card],o=function(t,a){t&&e.selected(t,a)},r="";e.payload&&(r=e.payload.buttonList.map((function(t,a){return Object(n.jsx)("li",{children:Object(n.jsx)(oe,{title:t.title,value:t.value,action:t.action,type:t.type,style:e.buttonStyle,click:o},a)},a)})));var i;i=e.payload&&e.payload.downloads?e.payload.downloads.map((function(t,a){return Object(n.jsx)("li",{children:Object(n.jsx)(_e,{title:t.title,url:t.url,type:t.type,file:t.file,downloadKo:t.downloadKo,downloadOk:t.downloadOk,style:e.dowloadStyle,click:o})},a)})):"";var s=e.payload&&e.payload.image?Object(n.jsx)("div",{className:ue.a.Image,children:Object(n.jsx)("img",{src:e.payload.image,alt:e.payload.title,"aria-label":t("card.image")})}):"",c=e.payload&&e.payload.title?Object(n.jsx)("div",{className:ue.a.Title,"aria-label":t("card.title"),children:e.payload.title}):"",l=e.payload&&e.payload.text?Object(n.jsx)("div",{className:ue.a.Description,"aria-label":t("card.description"),children:Object(n.jsx)("div",{dangerouslySetInnerHTML:{__html:e.payload.text}})}):"",u=e&&e.payload.buttonList.length?Object(n.jsx)("ul",{className:ue.a.Buttons,"aria-label":t("card.buttons"),children:r}):"",d=e.payload&&e.payload.downloads?Object(n.jsx)("ul",{className:[ue.a.Buttons,ue.a.Downloads].join(" "),"aria-label":t("card.downloads"),children:i}):"";return Object(n.jsxs)("div",{className:a.join(" "),style:e.style,role:"region",tabIndex:"0","aria-label":t("card.header"),children:[s,Object(n.jsxs)("div",{className:ue.a.Info,children:[c,l,u,d]})]})},Ce=a(7),ye=a(23),we=a.n(ye),Se=a(45),ke=a.n(Se),Ie=function(e){var t=Object(o.useState)(!1),a=Object(c.a)(t,2),r=a[0],i=a[1];Object(o.useEffect)((function(){if(!r&&e.value){i(!0);var t=e.options.find((function(t){return e.value===t.id}));e.setValue(e.id,e.value,t.value)}}),[r,e]);var s=[ke.a.Select,r?ke.a.Modified:""],l=Object(n.jsx)("option",{disabled:!0,value:"placeholder",children:e.placeholder},"placeholder"),u=e.options.map((function(e){return Object(n.jsx)("option",{value:e.id,children:e.value},e.id)}));u.unshift(l);return Object(n.jsxs)("div",{className:s.join(" "),children:[Object(n.jsx)("select",{id:e.id,onChange:function(t){r||i(!0);var a=e.options.find((function(e){return t.target.value===e.id}));e.setValue(e.id,t.target.value,a.value)},disabled:e.isDisabled,style:e.style,defaultValue:e.value||"placeholder",name:e.id,children:u}),Object(n.jsxs)("label",{htmlFor:e.id,children:[" ",e.label," "]})]})},Be=a(26),Me=a.n(Be),Ne=function(e){var t=Object(o.useState)(!1),a=Object(c.a)(t,2),r=a[0],i=a[1],s=[Me.a.Checkbox,r?Me.a.Modified:""];Object(o.useEffect)((function(){!r&&e.value&&(i(!0),e.setValue(e.id,e.value,null))}),[r,e]);var l="";return e.showErrors&&!e.isValid&&(s.push(Me.a.Invalid),l=Object(n.jsx)("div",{className:Me.a.Error,children:Object(n.jsxs)("span",{children:["\u26a0"," ",e.errorMessage]})})),Object(n.jsxs)("div",{className:s.join(" "),children:[Object(n.jsx)("input",{id:e.id,type:"checkbox",onChange:function(t){r||i(!0),console.log(t.target.checked),e.setValue(e.id,t.target.checked,null)},style:e.style,disabled:e.isDisabled,checked:e.value,name:e.id}),Object(n.jsxs)("label",{htmlFor:e.id,children:[" ",e.label," "]}),l]})},Ee=a(27),Le=a.n(Ee),Te=function(e){var t=Object(o.useState)(!1),a=Object(c.a)(t,2),r=a[0],i=a[1],s=[Le.a.TextInput,r?Le.a.Modified:""];Object(o.useEffect)((function(){!r&&e.value&&(i(!0),e.setValue(e.id,e.value,e.value))}),[r,e]);var l="";return e.showErrors&&!e.isValid&&(s.push(Le.a.Invalid),l=Object(n.jsx)("div",{className:Le.a.Error,children:Object(n.jsxs)("span",{children:["\u26a0"," ",e.errorMessage]})})),Object(n.jsxs)("div",{className:s.join(" "),children:[Object(n.jsx)("input",{id:e.id,onChange:function(t){r||i(!0),e.setValue(e.id,t.target.value,t.target.value)},style:e.style,placeholder:e.placeholder,disabled:e.isDisabled,value:e.value,name:e.id}),Object(n.jsxs)("label",{htmlFor:e.id,children:[" ",e.label," "]}),l]})},De=function(e){var t=Object(v.a)("global").t,a=Object(o.useState)(""),r=Object(c.a)(a,2),i=r[0],s=r[1],l=Object(o.useState)([]),u=Object(c.a)(l,2),d=u[0],b=u[1],p=Object(o.useState)(!1),h=Object(c.a)(p,2),g=h[0],f=h[1],j=Object(o.useState)(e.isDisabled),m=Object(c.a)(j,2),O=m[0],_=m[1];Object(o.useEffect)((function(){var a=e.payload.inputs.map((function(e){return Object(Ce.a)(Object(Ce.a)({},{value:e.value||"",altText:"",isValid:!e.required,errorMessage:t("form.defaultError")}),e)}));s(e.payload.id),b(a)}),[]);var x,C=function(t,a){var n=!!d.find((function(e){return!e.isValid}));if(n)f(n);else{var o={form:{id:i,inputs:d.map((function(e){return{id:e.id,value:e.value}}))}},r=d.map((function(e){return e.altText}));r=r.filter((function(e){return e})).join(", "),e.selected(t,r||a,o),_(!0)}},y=function(t,a){e.selected(t,a),_(!0)},w=function(e,t,a){var n=Object(k.a)(d),o=n.find((function(t){return t.id===e}));o.value=t,o.altText=a;var r=function(e){var t=!0,a=e.errorMessage;if(e.required&&!e.value&&(t=!1),e.validations)for(var n=0;n<e.validations.length;n++)if(!new RegExp(e.validations[n].regex).test(e.value)){t=!1,a=e.validations[n].errorMessage;break}return[t,a]}(o),i=Object(c.a)(r,2);o.isValid=i[0],o.errorMessage=i[1],b(n)},S=[we.a["".concat(e.origin,"-message")],we.a.Form];x=d.map((function(e,t){var a="";switch(e.type){case"select":a=Object(n.jsx)(Ie,Object(Ce.a)({setValue:w,isDisabled:O},e));break;case"text":a=Object(n.jsx)(Te,Object(Ce.a)({setValue:w,isDisabled:O,showErrors:g},e));break;case"checkbox":a=Object(n.jsx)(Ne,Object(Ce.a)({setValue:w,isDisabled:O,showErrors:g},e))}return Object(n.jsx)("li",{children:a},t)}));var I,B=Object(n.jsx)("ul",{className:we.a.Inputs,"aria-label":t("form.inputs"),children:x});I=e.payload.buttons.map((function(t,a){var o="cancel"===t.type?y:C,r="cancel"!==t.type&&!d.find((function(e){return e.required&&!e.value}));return Object(n.jsx)("li",{children:Object(n.jsx)(oe,{title:t.title,value:t.value,action:t.action,type:t.type,style:e.buttonStyle,isDisabled:r||O,click:o})},a)}));var M=e.payload.buttons.length?Object(n.jsx)("ul",{className:we.a.Buttons,"aria-label":t("form.buttons"),children:I}):"";return Object(n.jsx)("div",{className:S.join(" "),style:e.style,role:"region",tabIndex:"0","aria-label":t("form.header"),children:Object(n.jsxs)("form",{id:e.id,className:we.a.Info,onKeyPress:function(e){13===e.charCode&&e.preventDefault()},children:[B,M]})})},Fe=a(46),Ae=a.n(Fe),Re=a(64),Ue=a.n(Re),Ve=function(e){return Object(n.jsx)("div",{className:Ue.a.Backdrop,onClick:e.clicked,children:e.children})},We=function(e){var t=Object(o.useState)(!1),a=Object(c.a)(t,2),i=a[0],s=a[1];var l=i?Object(n.jsx)(Ve,{fullWindow:!0,show:i,clicked:function(){s(!1)},children:Object(n.jsx)("img",{className:Ae.a.FullSizeImage,src:e.payload.image,alt:""})}):null;return Object(n.jsxs)(r.a.Fragment,{children:[Object(n.jsx)("div",{className:Ae.a.Image,style:e.style,children:Object(n.jsx)("img",{src:e.payload.image,onClick:function(){s(!0)},alt:""})}),l]})},ze=function(e){var t=Object(v.a)("global").t,a=Object(o.useRef)(null);Object(o.useEffect)((function(){a.current.scrollTop=a.current.scrollHeight-a.current.clientHeight}));var r=function a(o){return o.map((function(r,i){var s=r.fromUser?"User":"Bot";switch(r.type){case"text":return Object(n.jsx)($,{position:r.position,origin:s,fromUser:r.fromUser,payload:r.payload,agentChat:r.agentChat,now:r.now},i);case"quick_reply":return Object(n.jsx)(re,{position:r.position,origin:s,payload:r.payload,selected:e.sendMsg,getClick:e.pushButton},i);case"CARRUSEL":return console.log("--CARRUSEL--",r.type),Object(n.jsx)(ce,{origin:s,type:r.type,children:a(r.payload.items)},i);case"form":console.log("--FORM--",r.type);var c=i!==o.length-1;return Object(n.jsx)(De,{position:r.position,origin:s,payload:r.payload,selected:e.sendMsg,isDisabled:c},i);case"card":console.log("--CARD--",r.type);var l=[];return r.buttonList&&(l=r),Object(n.jsx)(xe,{position:r.position,origin:s,payload:l,selected:e.sendMsg},i);case"image":return console.log("--IMAGE--",r.type),Object(n.jsx)(We,{origin:s,payload:r.payload},i);case"buttons":return console.log("--BUTTONS--",r.type),Object(n.jsx)(oe,{position:r.position,origin:s,name:r.name,value:r.value,type:r.flow,action:r.action},i);default:return console.log("--DEFAULT--",r.type),Object(n.jsx)($,{position:r.position,origin:"Bot",fromUser:r.fromUser,setIsAgent:e.setIsAgent,agentChat:r.agentChat,now:r.now,payload:{text:t("chatbody.error-msg")}},i)}}))}(e.messages);return Object(n.jsx)("div",{className:J.a.ChatBody,tabIndex:"0","aria-live":"polite",role:"region","aria-label":t("chatbody.title"),ref:a,children:Object(n.jsxs)("div",{className:J.a.MessagesContainer,children:[r,e.showSpinner?Object(n.jsx)(Q,{}):""]})})},Pe=a(3),He=a.n(Pe),qe=a(6),Ke=a(11),Je=a.n(Ke),Ge=a(32),Ze=a(28),Qe=a.n(Ze),Xe=function(e){Object(v.a)("global").t,Qe.a.RecordButton;var t=Object(o.useState)(""),a=Object(c.a)(t,2),r=(a[0],a[1]),i=Object(Ge.a)({continuous:!0,useLegacyResults:!1}),s=i.error,l=i.interimResult,u=(i.isRecording,i.results,i.startSpeechToText,i.stopSpeechToText);return console.log(s),Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("textarea",{className:Qe.a.Textarea,name:"commentTextArea",type:"text",rows:"1",onChange:function(t){r(JSON.stringify(l)),e.setInputValue(t.target.value),console.log("JSON.stringify(interimResult)",JSON.stringify(l))},onKeyPress:function(t){13===t.charCode&&e.sendInputValue(t.target.value)},value:e.setVal}),Object(n.jsx)("button",{className:Qe.a.ChatFooterKeyboardButton,onClick:function(){u(),e.setKeyBoardMode(!0)},children:Object(n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",role:"img","aria-label":"Speak a message",className:Qe.a.KeyboardButton,children:[Object(n.jsx)("path",{fill:"none",d:"M0 0h24v24H0V0zm0 0h24v24H0V0z"}),Object(n.jsx)("path",{d:"M20 7v10H4V7h16m0-2H4c-1.1 0-1.99.9-1.99 2L2 17c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-9 3h2v2h-2zm0 3h2v2h-2zM8 8h2v2H8zm0 3h2v2H8zm-3 0h2v2H5zm0-3h2v2H5zm3 6h8v2H8zm6-3h2v2h-2zm0-3h2v2h-2zm3 3h2v2h-2zm0-3h2v2h-2z"})]})})]})},Ye=a(47),$e=a.n(Ye),et=a(66),tt=function(e,t){var a=t.options,r=void 0===a?[]:a,i=Object(v.a)("global").t,s=Object(o.useState)(!1),l=Object(c.a)(s,2),u=(l[0],l[1],Object(o.useState)("")),d=Object(c.a)(u,2),b=d[0],p=d[1],h=Object(o.useState)(!1),g=Object(c.a)(h,2),f=g[0],j=g[1];r=et;var m=Object(o.useRef)(null),O=r.filter((function(e){return b.trim().length>2?e.toLowerCase().includes(b.toLowerCase()):""}));Object(o.useEffect)((function(){p(""),j(!1)}),[e.reset]);return Object(n.jsxs)(n.Fragment,{children:[Object(n.jsx)("textarea",{value:b,className:$e.a.InputText,type:"text",placeholder:i("chatfooter.input.placeholder"),title:i("chatfooter.input.title"),"aria-label":i("chatfooter.input.title"),onChange:function(t){p(t.target.value),e.setInputValue(t.target.value),e.getData(t.target.value)},onKeyPress:function(t){13===t.charCode?(t.preventDefault(),j(!1),e.sendInputValue(t.target.value)):j(!0)},onKeyDown:function(e){"Enter"===e.key&&(j(!1),p(""))},disabled:e.setDisabled,ref:m,rows:b.length>32?2:1}),f&&Object(n.jsx)("ul",{className:$e.a.suggestions,children:O.map((function(t){return Object(n.jsx)("li",{onClick:function(){return function(t){p(""),e.sendSuggestion(t),j(!1)}(t)},children:t},t)}))})]})},at=function(e){for(var t=Object(v.a)("global").t,a=[Je.a.RecordButton],r=[Je.a.SendButton],i=[Je.a.inputFile],s=[Je.a.ClassLabel],l=Object(o.useState)(!0),u=Object(c.a)(l,2),d=(u[0],u[1]),b=Object(o.useState)(!0),p=Object(c.a)(b,2),h=p[0],g=p[1],f=Object(o.useState)(!1),j=Object(c.a)(f,2),m=j[0],O=j[1],_=Object(o.useState)(""),x=Object(c.a)(_,2),C=x[0],y=x[1],w=Object(Ge.a)({continuous:!0,useLegacyResults:!1}),S=w.error,k=w.interimResult,I=w.isRecording,B=(w.results,w.startSpeechToText),M=w.stopSpeechToText,N=[],E=0;E<20;E++)N.push(Object(n.jsx)("div",{className:Je.a.items},E));Object(o.useEffect)((function(){h||(void 0===k?C.length>0&&(e.sendVoice(C),L()):y(k))}),[k]);var L=function(){g(!0),M()},T=function(){var t=Object(qe.a)(He.a.mark((function t(a){var n,o,r,i,s;return He.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.target.files[0],t.next=3,D(n);case 3:o=t.sent,r=o.split(","),i=r[1],s={name:"prueba.pdf",originalBase64:i,type:"application/pdf"},e.directSocketConnection.sendAttachment(s).then((function(e){console.log("responseAttachment",e)})).catch((function(e){return console.log(e)}));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),D=function(e){return new Promise((function(t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(){t(n.result)},n.onerror=function(e){a(e)}}))};return console.log(S),Object(n.jsxs)("div",{className:Je.a.ChatFooter,role:"region","aria-label":t("chatfooter.title"),children:[h&&Object(n.jsxs)("div",{className:Je.a.ChatFooterModeKeyboard,children:[Object(n.jsx)(tt,{setInputValue:e.setInputValue,sendInputValue:e.send,reset:m,getData:function(e){d(e.length<=0)},sendSuggestion:e.sendSuggestion,setDisabled:e.setDisabled}),Object(n.jsx)("button",{className:r.join(" "),onClick:function(){e.send(),O(!m),d(!0)},disabled:e.setDisabled,title:"Enviar",children:Object(n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",role:"img","aria-label":"Send a message",className:r,children:Object(n.jsx)("path",{d:"M23.794125,0.206015625 C23.5952344,0.007078125 23.2968281,-0.05409375 23.0358281,0.05034375 L0.44203125,9.08775 C0.183515625,9.19115625 0.01040625,9.43734375 0.00046875,9.71564063 C-0.009421875,9.99389063 0.145828125,10.25175 0.396328125,10.37325 L9.30576563,14.6942344 L13.6267969,23.6036719 C13.7446406,23.8466719 13.9907344,24 14.2592813,24 C14.267625,24 14.2760156,24 14.2844063,23.9995313 C14.5626094,23.9896406 14.8088906,23.8165313 14.91225,23.5580156 L23.94975,0.964359375 C24.0541875,0.703171875 23.9930156,0.40490625 23.794125,0.206015625 Z M2.44190625,9.80240625 L20.3775,2.62823437 L9.68864063,13.317 L2.44190625,9.80240625 Z M14.1976406,21.5581406 L10.683,14.3113125 L21.3719063,3.62254687 L14.1976406,21.5581406 Z",id:"Shape"})})}),Object(n.jsx)("button",{onClick:function(){g(!1),I?M():B()},className:a.join(" "),title:"Hablar un mensaje",disabled:e.setDisabled,children:Object(n.jsx)("svg",{"data-recording":I,xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",role:"img","aria-label":"Speak a message",className:a,children:Object(n.jsx)("path",{d:"M7 23v-2h4v-2.062C7.06 18.444 4 15.073 4 11h2c0 3.309 2.691 6 6 6s6-2.691 6-6h2c0 4.072-3.059 7.444-7 7.938V21h4v2h-6zm5-22c2.206 0 4 1.794 4 4v6c0 2.206-1.794 4-4 4s-4-1.794-4-4V5c0-2.206 1.794-4 4-4zm0 2c-1.103 0-2 .897-2 2v6c0 1.103.897 2 2 2s2-.897 2-2V5c0-1.103-.897-2-2-2z"})})}),e.setIsAgent&&Object(n.jsxs)("label",{className:s,children:[Object(n.jsx)("input",{id:"originalFileName",type:"file",required:!0,label:"Document",name:"originalFileName",onChange:function(e){return T(e)},size:"small",className:i,disabled:e.setDisabled}),Object(n.jsx)("svg",{version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg",x:"24",y:"24",viewBox:"0 0 512 512",className:a,children:Object(n.jsx)("path",{d:"M467.076,68.86c-59.902-59.902-156.846-59.896-216.741,0L34.919,284.276c-46.558,46.557-46.558,122.312,0,168.87\r c46.57,46.571,122.326,46.544,168.87,0L419.205,237.73c33.36-33.36,33.36-87.64,0-121c-33.359-33.361-87.64-33.361-121,0\r L114.478,300.457c-6.975,6.975-6.975,18.285,0,25.259c6.975,6.975,18.285,6.975,25.259,0l183.727-183.727\r c19.432-19.432,51.05-19.432,70.481,0c19.431,19.432,19.431,51.05,0,70.481L178.53,427.887c-32.71,32.71-85.646,32.706-118.352,0\r c-15.806-15.806-24.511-36.821-24.511-59.175s8.706-43.369,24.511-59.176L275.594,94.119c45.94-45.94,120.287-45.934,166.222,0\r c45.827,45.828,45.827,120.395,0,166.222l-95.741,95.741c-6.975,6.975-6.975,18.284,0,25.259s18.285,6.975,25.259,0l95.741-95.741\r C526.978,225.7,526.971,128.754,467.076,68.86z"})})]})]}),!h&&Object(n.jsxs)("div",{className:Je.a.ChatFooterModeVoice,children:[Object(n.jsx)("div",{className:Je.a.ChatFooterVisualizerWrapper,children:Object(n.jsx)("div",{className:Je.a.wave,children:N})}),Object(n.jsx)("div",{className:Je.a.ChatFooterRecognitionWrapper,children:Object(n.jsx)(Xe,{setInputValue:e.setInputValue,sendInputValue:e.send,setKeyBoardMode:L,setVal:k})})]})]})},nt=function(e){return{type:"MESSAGES_CURRENT",current:e}},ot=a(117),rt=a(67),it=function(){return(new Date).toLocaleString("es-ES",{hour:"2-digit",minute:"2-digit",hour12:!1})},st=Object(ot.a)("global")((function(e){var t=Object(v.a)("global").t,a=Object(l.b)(),i=Object(l.c)((function(e){return e.messagesContainer.messages})),s=Object(o.useState)(!1),u=Object(c.a)(s,2),d=u[0],b=u[1],p=Object(o.useState)(""),h=Object(c.a)(p,2),g=h[0],f=h[1],j=Object(o.useState)(""),m=Object(c.a)(j,2),O=(m[0],m[1]),_=Object(o.useState)(!1),x=Object(c.a)(_,2),C=x[0],y=x[1],w=Object(o.useState)(!1),S=Object(c.a)(w,2),I=S[0],M=S[1],N=function(e){console.log(e);var a=new T({fromUser:!1,text:t("chatbody.error-msg")});D([a])};Object(o.useEffect)((function(){i.length||(sessionStorage.removeItem("allMsgs"),b(!1),e.connection.sendInitialMessage().then((function(e){return D(e)})).catch((function(e){N()})))}),[]);var E=function(){if(!(g.length<=0)){console.log("isModeAgent",C);var e=g,t=new T({fromUser:!0,text:e,agentChat:C,now:it()});f(""),D([t]),L(e,[t])}},L=function(a,n){return b(!0),console.log("parametro del user"+a),a===t("agent.agentChat")?(sessionStorage.setItem("agent",0),void A()):"CERRAR"===a&&C?(y(!1),void R(g,"endOfConversation",!1)):void(C?(console.log("enviar mensaje agente"),f(""),R(a,"message",!0)):e.connection.sendMessage(a).then((function(e){console.log("datos de la respuesta",e);var t=[].concat(Object(k.a)(n),Object(k.a)(e));D(t)})).catch((function(e){N()})))},D=function(e){console.log("n mensajes",e.length);var t=[].concat(Object(k.a)(i),Object(k.a)(e));!function(e,t){var a=e.length;console.log("mensajes",e),sessionStorage.setItem("allMsgs",JSON.stringify(e)),e.forEach((function(e,n){n<a-t&&"quick_reply"===e.type&&e.payload.buttons.forEach((function(e){e.value="",e.type="disabled"})),n<a-t&&"CARRUSEL"===e.type&&e.payload.items.forEach((function(e){e.buttonList.forEach((function(e){e.value="",e.type="disabled"}))}))}))}(t,e.length-1),a(nt(t)),b(!1)},F=function(t){console.log("response connect",t);var n=new rt.w3cwebsocket(e.directSocketConnection.urlSocket);n.onopen=function(){console.log("WebSocket Client Connected"),y(!0),sessionStorage.getItem("allMsgs");var e=function(e){var t=JSON.parse(e),a="";return t.forEach((function(e){"text"===e.type&&(a=a+"<br>"+(e.fromUser?"Ciudadano:":"Ayuntamiento (bot):")+e.payload.text)})),a}(sessionStorage.getItem("allMsgs"));R(e,"message",!1,!0)},n.onclose=function(){console.log("closing connection"),console.log("Socket hard closed",n.readyState)},n.onmessage=function(e){console.log("respuesta del socket",e);var t=JSON.parse(sessionStorage.getItem("allMsgs"));if(e.data){var o=JSON.parse(e.data);if(console.log("respuesta del socket json",o),"Fin de la conversacion"===o.activities[0].text){console.log("mensaje de final de la conversacion"),y(!1);var r=new T({fromUser:!1,text:"<strong>La conversaci\xf3n con el agente ha finalizado</strong>",agentChat:!0,now:it()}),i=[].concat(Object(k.a)(t),[r]);sessionStorage.setItem("allMsgs",JSON.stringify(i)),a(nt(i)),n.close(),M(!0)}else if(o.activities[0].attachments&&"user"!==o.activities[0].from.id){sessionStorage.setItem("agent",1);var s=new T({fromUser:!1,text:'Fichero recibido: [<a href="'+o.activities[0].attachments[0].contentUrl+'"target="_blank">'+o.activities[0].attachments[0].name+"</a>]",agentChat:!0,now:it()}),c=[].concat(Object(k.a)(t),[s]);sessionStorage.setItem("allMsgs",JSON.stringify(c)),a(nt(c))}else if("user"===o.activities[0].from.id){if(console.log("es el usuario",o.activities[0]),"0"===sessionStorage.getItem("agent")&&o.activities[0].text&&o.activities[0].text.length<20){var l=new T({fromUser:!1,text:"Seguimos intentando ponerle en contacto con un agente. Por favor, espere en l\xednea.",agentChat:!0,now:it()}),u=[].concat(Object(k.a)(t),[l]);sessionStorage.setItem("allMsgs",JSON.stringify(u)),a(nt(u))}}else{sessionStorage.setItem("agent",1);var d=new T({fromUser:!1,text:o.activities[0].text,agentChat:!0,now:it()}),p=[].concat(Object(k.a)(t),[d]);sessionStorage.setItem("allMsgs",JSON.stringify(p)),a(nt(p))}b(!1)}}},A=function(){e.directSocketConnection.connect().then((function(e){F(e)})).catch((function(e){return console.log(e)}))},R=function(t,n,o){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i={locale:"es-ES",type:n,from:{id:"user"},text:t};e.directSocketConnection.sendMessageAgent(i).then((function(e){if(console.log("responseSendMessage",e),!o){var n=JSON.parse(sessionStorage.getItem("allMsgs")),i=new T({fromUser:o,text:r?"Le doy la bienvenida al <strong>Chat Online de L\xednea Madrid</strong>. Estamos buscando a la persona m\xe1s apropiada para que le asista \ud83d\ude42.<br><br>En cuanto haya un agente disponible, se le notificar\xe1 por esta v\xeda":t,agentChat:!0,now:it()}),s=[].concat(Object(k.a)(n),[i]);sessionStorage.setItem("allMsgs",JSON.stringify(s)),a(nt(s)),b(!1)}})).catch((function(e){return console.log(e)}))},U=Object(n.jsxs)("div",{className:B.a.ChatContainer,role:"region","aria-label":t("chatcontainer.title"),children:[Object(n.jsx)(q,{close:e.closeChat}),Object(n.jsx)(ze,{messages:i,showSpinner:d,setIsAgent:C,sendMsg:E,pushButton:function(t){if("GET_LOCATION"!==t){var a=new T({fromUser:!0,text:t});D([a]),L(t,[a])}else!function(){if(navigator.geolocation)navigator.geolocation.getCurrentPosition((function(t){e.connection.longitud=t.coords.longitude,e.connection.latitud=t.coords.latitude,e.connection.sendMessage("GET_LOCATION").then((function(e){var t=[new T({fromUser:!0,text:"Informaci\xf3n enviada"})].concat(Object(k.a)(e));D(t)})).catch((function(e){return console.log(e)}))}),(function(){console.log("Unable to retrieve your location");var e=new T({fromUser:!1,text:"Permiso de localizaci\xf3n denegado.<br>Por favor, permita el acceso para compartir su ubicaci\xf3n, o escriba su ubicaci\xf3n."});D([e])}));else{console.log("Geolocation is not supproted by your broswer");var t=new T({fromUser:!1,text:"La ubicaci\xf3n no est\xe1 soportada por el explorador."});D([t])}}()}}),Object(n.jsx)(at,{send:E,sendVoice:function(e){if(!(e.length<=0)){var t=e,a=new T({fromUser:!0,text:t});D([a]),L(t,[a])}},setInputValue:f,sendInputValue:O,sendSuggestion:function(e){var t=new T({fromUser:!0,text:e});f(""),D([t]),L(e,[t])},setIsAgent:C,setDisabled:I,directSocketConnection:e.directSocketConnection})]});return Object(n.jsx)(r.a.Fragment,{children:e.show?U:""})})),ct=function e(){var t=this;Object(E.a)(this,e),this.getIpdata=Object(qe.a)(He.a.mark((function e(){return He.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){Oe.a.get("https://api.ipdata.co?api-key=".concat(t.ipDataToken)).then(function(){var a=Object(qe.a)(He.a.mark((function a(n){var o,r,i;return He.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return console.log("valores de ipData",n.data.threat),o=n.data.threat,r=!0,(o.is_tor||o.is_anonymous||o.is_known_attacker||o.is_known_abuser||o.is_threat||o.is_bogon||o.scores&&(o.scores.threat_score>80||o.scores.trust_score<40))&&(r=!1),a.next=6,t.addInfoIPData(n.data);case 6:i=a.sent,console.log(i),e(r);case 9:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()).catch((function(e){console.log("err",e),a()}))})));case 1:case"end":return e.stop()}}),e)}))),this.addInfoIPData=function(){var e=Object(qe.a)(He.a.mark((function e(a){return He.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var o=[];o.Authorization="Bearer "+t.evaToken,a=JSON.stringify({title:"foo",body:"bar",userId:1}),Oe.a.post("https://jsonplaceholder.typicode.com/posts",a,{headers:o}).then((function(t){console.log("response update",t),e(t)})).catch((function(t){return console.log("err",t),e(!0)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.ipDataToken="ac4f761f5285ed90491c428b564236f4148e700611136b8416215f3c"},lt=function e(){var t=this;Object(E.a)(this,e),this.sendInitialMessage=function(){return new Promise((function(e,a){t.connect().then((function(){return e()})).catch((function(e){return a(e)}))}))},this.connect=Object(qe.a)(He.a.mark((function e(){return He.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,a){var n={headers:{Authorization:"Bearer ".concat(t.token)}};Oe.a.post("https://directline.botframework.com/v3/directline/conversations",{key:"value"},n).then((function(a){return console.log("respuesta de la llamada a conexi\xf3n",a),t.urlSocket=a.data.streamUrl,t.conversationId=a.data.conversationId,e()})).catch((function(t){return console.log("error:",t),e()}))})));case 1:case"end":return e.stop()}}),e)}))),this.sendMessageAgent=function(){var e=Object(qe.a)(He.a.mark((function e(a){return He.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var o={headers:{Authorization:"Bearer ".concat(t.token)}};Oe.a.post("https://directline.botframework.com/v3/directline/conversations/".concat(t.conversationId,"/activities"),a,o).then((function(a){return console.log("respuesta send messsage",a),e(t.response)})).catch((function(t){return console.log("error:",t),e()}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.sendAttachment=function(){var e=Object(qe.a)(He.a.mark((function e(a){return He.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var o={headers:{Authorization:"Bearer ".concat(t.token),"Content-Type":"application/pdf","Content-Disposition":'name="prueba"; filename="prueba.pdf"'}};Oe.a.post("https://directline.botframework.com/v3/directline/conversations/".concat(t.conversationId,"/upload?userId=user"),a,o).then((function(a){return console.log("respuesta send messsage",a),e(t.response)})).catch((function(t){return console.log("error:",t),e()}))})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.conversationId="",this.urlSocket="",this.token="svZti5yN7QE.1W7gEoBQkQDj0VY4Ut9FA1uqUkq_q52iR6w6ghXB4RM"},ut=a(69),dt=a.n(ut);console.log("valor","GTM-NXRKM8W"),dt.a.initialize({gtmId:"GTM-NXRKM8W",dataLayer:[{Vendor:"Ayuntamiento de Madrid"}]});var bt=function(e){var t=Object(l.b)(),a=Object(l.c)((function(e){return e.chatApp.chatIsOpen})),r=Object(o.useState)(!0),i=Object(c.a)(r,2),s=i[0],u=i[1],d=new ct,b=new lt,p=function(e){"chat"===e?d.getIpdata().then((function(e){console.log("valor de la respuesta",e),e&&t(function(e){return{type:"CHAT_ISOPEN",chat:e}}(!a))})).catch((function(e){return console.log(e)})):u("bigButton"===e)};return Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)(S,{show:!a&&!s,click:p}),Object(n.jsx)(m,{show:!a&&s,click:p}),a&&Object(n.jsx)(st,{show:a,closeChat:p,connection:e.connection,directSocketConnection:b})]})},pt=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,119)).then((function(t){var a=t.getCLS,n=t.getFID,o=t.getFCP,r=t.getLCP,i=t.getTTFB;a(e),n(e),o(e),r(e),i(e)}))},ht=a(118),gt=a(48),ft=a(70),jt={messages:[]},vt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:jt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MESSAGES_CURRENT":return Object(Ce.a)(Object(Ce.a)({},e),{},{messages:t.current});default:return e}},mt=a(49),Ot={chatIsOpen:!1},_t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ot,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHAT_ISOPEN":return Object(Ce.a)(Object(Ce.a)({},e),{},{chatIsOpen:t.chat});default:return e}},xt=function(e){console.log("data",e);var t=e.data.context,a=e.data.sessionCode,n=e.data.answers,o=[];return n.forEach((function(e){if("CARRUSEL"!==e.content.type&&"IGNORE_ANSWER"!==e.content.type){var t=e.content,a=new T({fromUser:!1,text:t,agentChat:!1,now:""});o.push(a)}if(console.log("answers",e),e.buttons&&e.buttons.length){console.log("buttons true");var n=[];e.buttons.forEach((function(e){var t=new D({title:e.name,value:e.value,action:e.action,type:e.type});n.push(t)}));var r=new F({buttons:n});o.push(r)}if(e.quickReply&&e.quickReply.length){var i=[];e.quickReply.forEach((function(e){var t=new D({title:e.name,value:e.value,action:e.action,type:"quick_reply"});i.push(t)}));var s=new F({buttons:i});o.push(s)}if("CARRUSEL"===e.content.type){var c=[];e.content.content.forEach((function(e){c.push(e)}));var l=new A({items:c});o.push(l)}})),{messages:o,context:t,sessionCode:a}},Ct=a(71),yt=a.n(Ct),wt=function e(t){var a=t.text,n=t.code,o=t.context;Object(E.a)(this,e),this.text=a,this.code=n,this.context=o},St=function e(){var t=this;Object(E.a)(this,e),this.sendInitialMessage=function(){return new Promise((function(e,a){t.sendMessage("33wWrVrVwWRWVrvAw",null,{lang:"es",session:""}).then((function(t,a){return e(t,a)})).catch((function(e){return a(e)}))}))},this.getEvaToken=function(){return new Promise((function(e,a){var n={grant_type:t.eva4Config.token.grant_type,client_id:t.eva4Config.token.client_id,client_secret:t.eva4Config.token.client_secret},o=new URLSearchParams(n).toString();Oe.a.post("https://".concat(t.eva4Config.token.keycloak_ur,"/auth/realms/").concat(t.eva4Config.token.org_name,"/protocol/openid-connect/token"),o).then((function(t){var a=t.data.access_token;return e(a)})).catch((function(e){return a(e)}))}))},this.sendMessage=function(){var e=Object(qe.a)(He.a.mark((function e(a,n,o){return He.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.evaToken){e.next=4;break}return e.next=3,t.getEvaToken();case 3:t.evaToken=e.sent;case 4:return e.abrupt("return",new Promise((function(e,r){var i={lng:"es",latitud:t.latitud,longitud:t.longitud},s=new wt({text:a||"",code:n||"",context:i}),c=o?o.session:t.sessionCode,l=t.eva4Config.conversation.headers;l["USER-REF"]=t.userRef,l.Authorization="Bearer "+t.evaToken;var u=t.eva4Config.conversation.url.botUUID;Oe.a.post("https://api-".concat(t.eva4Config.conversation.url.instance,".eva.bot/eva-broker/org/").concat(t.eva4Config.conversation.url.orgUUID,"/env/").concat(t.eva4Config.conversation.url.envUUID,"/bot/").concat(u,"/conversations/").concat(c),s,{headers:l}).then((function(a){var n=xt(a),o=n.messages,r=n.context,i=n.sessionCode;return t.context=r,t.sessionCode=i,e(o,i)})).catch((function(r){return r.response&&401===r.response.status?(t.evaToken="",e(t.sendMessage(a,n,o))):e()}))})));case 5:case"end":return e.stop()}}),e)})));return function(t,a,n){return e.apply(this,arguments)}}(),this.sessionCode="",this.eva4Config=yt.a.eva4Config,this.userRef=Math.floor(1e18*Math.random()+1),this.evaToken="",this.longitud="",this.latitud=""},kt=Object(mt.a)({messagesContainer:vt,chatApp:_t}),It=Object(mt.b)(kt);console.log(It.getState()),gt.a.init({interpolation:{escapeValue:!1},lng:"es",resources:{es:{global:ft}}});var Bt=new St;s.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)(ht.a,{i18n:gt.a,children:Object(n.jsx)(l.a,{store:It,children:Object(n.jsx)(bt,{connection:Bt})})})}),document.getElementById("root")),pt()},12:function(e,t,a){e.exports={Card:"Card_Card__1j9Yv",Image:"Card_Image__Mzyun",Info:"Card_Info__3RWFA",Title:"Card_Title__1LJQl",Buttons:"Card_Buttons__3y5hG",Description:"Card_Description__1JTl0"}},16:function(e,t,a){e.exports={ChatHeader:"ChatHeader_ChatHeader__-vC8j",HeaderAndLogo:"ChatHeader_HeaderAndLogo__1szjx",MoveAndCloseIcon:"ChatHeader_MoveAndCloseIcon__3ol1v",Logo:"ChatHeader_Logo__yjg3U",Title:"ChatHeader_Title__2l5n7",HideText:"ChatHeader_HideText__1BL0B",CloseButton:"ChatHeader_CloseButton__1_mUR"}},17:function(e,t,a){e.exports={carouselContainer:"Carousel_carouselContainer__3-iqy",carouselWrapper:"Carousel_carouselWrapper__3qTrK",carouselContentWrapper:"Carousel_carouselContentWrapper__26550",carouselContent:"Carousel_carouselContent__2bfFB",leftArrow:"Carousel_leftArrow__wcDH3",rightArrow:"Carousel_rightArrow__1AF33"}},21:function(e,t,a){e.exports={Spinner:"Spinner_Spinner__36AKZ",DotContainer:"Spinner_DotContainer__23QQb",Dot:"Spinner_Dot__3D1uM",fade:"Spinner_fade__1oHFa"}},22:function(e,t,a){e.exports={TextMessage:"TextMessage_TextMessage__19lOM","Bot-message":"TextMessage_Bot-message__2w1n9","User-message":"TextMessage_User-message__Ee-7n",ImgAvatar:"TextMessage_ImgAvatar__1r9sf",WithAvatar:"TextMessage_WithAvatar__1IWRU"}},23:function(e,t,a){e.exports={Form:"Form_Form__3m9W-",Inputs:"Form_Inputs__3w3DE",Buttons:"Form_Buttons__1OXXq",button:"Form_button__2MUJN"}},25:function(e,t,a){e.exports={Button:"Button_Button__2ii-m",ButtonClicked:"Button_ButtonClicked__3zJMW",Button_cancel:"Button_Button_cancel__2BXAi",Secondary:"Button_Secondary__1aKTt",Disabled:"Button_Disabled__PXpwt"}},26:function(e,t,a){e.exports={Checkbox:"Checkbox_Checkbox__3mdqk",Error:"Checkbox_Error__3UzM6"}},27:function(e,t,a){e.exports={TextInput:"TextInput_TextInput__hJr-O",Modified:"TextInput_Modified__2YMv5",Error:"TextInput_Error__1tkZx",Invalid:"TextInput_Invalid__3iOLe"}},28:function(e,t,a){e.exports={ChatFooterKeyboardButton:"Textarea_ChatFooterKeyboardButton__MGbQz",KeyboardButton:"Textarea_KeyboardButton__pzUV2"}},34:function(e,t,a){e.exports={WidgetButtonContainer:"WidgetButton_WidgetButtonContainer__3Hqez",WidgetButton:"WidgetButton_WidgetButton__Oqrqu",CloseButton:"WidgetButton_CloseButton__2ZKql",Widget:"WidgetButton_Widget__hm_gV"}},35:function(e,t,a){e.exports={BubbleContainer:"Bubble_BubbleContainer__2c5Si","slide-top":"Bubble_slide-top__3Sd2I",Bubble:"Bubble_Bubble__1Nf8m",CloseButton:"Bubble_CloseButton__BNBke"}},36:function(e,t,a){e.exports={QuickReply:"QuickReply_QuickReply__1U3Kf",VerticalButtons:"QuickReply_VerticalButtons__2jM7k"}},41:function(e,t,a){e.exports={BubbleContainer:"Bubble_BubbleContainer__2Cjvc","slide-top":"Bubble_slide-top__32NyS",Bubble:"Bubble_Bubble__1pqTz",CloseButton:"Bubble_CloseButton__356KX"}},42:function(e,t,a){e.exports={WidgetButtonSmall:"WidgetButtonSmall_WidgetButtonSmall__9GCKt",WidgetSmall:"WidgetButtonSmall_WidgetSmall__2UgRs"}},43:function(e,t,a){e.exports={ChatBody:"ChatBody_ChatBody__3X1RW",MessagesContainer:"ChatBody_MessagesContainer__2tJYI",fade:"ChatBody_fade__1Yc86"}},44:function(e,t,a){e.exports={Download:"Download_Download__31L9C",DownloadClicked:"Download_DownloadClicked__1lgoj",Download_cancel:"Download_Download_cancel__2dlQm"}},45:function(e,t,a){e.exports={Select:"Select_Select__1m9PV",Modified:"Select_Modified__3PnaM"}},46:function(e,t,a){e.exports={Image:"Image_Image__14qWL",FullSizeImage:"Image_FullSizeImage__3KeXZ"}},47:function(e,t,a){e.exports={InputText:"InputText_InputText__r63qf",suggestions:"InputText_suggestions__1-i3g","popup-suggestion":"InputText_popup-suggestion__zTMZf"}},63:function(e,t,a){e.exports={ChatContainer:"ChatContainer_ChatContainer__19VfF"}},64:function(e,t,a){e.exports={Backdrop:"Backdrop_Backdrop__3YNMM"}},66:function(e){e.exports=JSON.parse('["Acceder Distrito Centro","Acceso Distrito Centro","acceso para personas sin distintivo","agente","Alta","alta de invitaciones para un d\xeda","alta de una invitaci\xf3n","alta en el padr\xf3n","alta padr\xf3n","Baja","baja a tercero","baja a un permiso","baja de un permiso","baja padr\xf3n","baja por deceso","baja por traslado a otra ciudad","baja por traslado al extranjero","Buenas","buenas noches","buenas tardes","buenos d\xedas ","Buscar","buscar aparcamiento","buscar parking","buscar parkings disponibles","buscar por ubicaci\xf3n","Calles","Calles del Distrito Centro","calles en plaza el\xedptica","certificado empadronamiento","Chat","chat con agente","Criterios / Acceso","criterios de acceso","Dar","dar de alta matr\xedcula","Dar de alta un permiso","dar de baja matr\xedcula","Dar de baja un permiso","Distintivo ","Distintivo ambiental C","distintivos ambientales","Distrito","Distrito Centro","empadronarme","empadronarme en Madrid","Empadronarse/Empadronarme","Extranjero / extranjera","extranjero sin residencia permanente","Garaje","hablar con un agente","Hola","Informaci\xf3n","Informaci\xf3n Distintivos Ambientales","informaci\xf3n Distrito Centro","Informaci\xf3n Padr\xf3n","informaci\xf3n Plaza El\xedptica","Informaci\xf3n sobre los distintivos medioambientales","Invitaci\xf3n","invitaci\xf3n a una matr\xedcula","invitaci\xf3n para un coche","ir a chat con un agente","Ir al men\xfa principal","Ll\xe9vame al men\xfa ","Matr\xedcula","Men\xfa","Men\xfa principal","Modificar","modificar datos","modificar datos padr\xf3n","modificar datos personales padr\xf3n","modificar mis datos en el empadronamiento","necesito dar de baja un permiso","Padr\xf3n","Parking","parkings y garajes","pedir invitaci\xf3n","Permiso","Plaza ","Plaza El\xedptica","qu\xe9 calles del centro est\xe1n incluidas","quiero buscar parkings","quiero conocer los criterios de acceso","quiero eliminar un permiso","quiero informaci\xf3n de Distrito Centro","quiero informaci\xf3n del padr\xf3n","quiero informarme sobre la plaza el\xedptica","realizar una invitacion al centro","solicitar un permiso","soy extranjero y no s\xe9 cu\xe1ndo me caduca el padr\xf3n","ver garaje"]')},70:function(e){e.exports=JSON.parse('{"widget":{"title":"Ada, tu asistente de Carpeta Ciudadana","button":{"title":"Abrir chat"},"bubble":{"title":"Mensaje de bienvenida","text1":"\xa1Hola!","text2":"\xbfEn qu\xe9 puedo ayudarte?","close":"Ocultar el mensaje de bienvenida"}},"chatheader":{"title":"Cabecera del chat","bot-name":"Ada","close":"Ocultar el chat","move":"Mover el chat"},"chatfooter":{"title":"Campo de consulta del chat","send":"Enviar","input":{"placeholder":"Escriba aqu\xed","title":"Introduzca su consulta"}},"chatbody":{"title":"Contenido del chat","error-msg":"El servicio no est\xe1 disponible temporalmente. Vuelva a intentarlo en unos minutos."},"carousel":{"title":"Carrusel","arrow":{"left":"Mover carrusel a la izquierda","rigth":"Mover carrusel a la derecha"}},"card":{"header":"Tarjeta","title":"T\xedtulo de la tarjeta","description":"Descripci\xf3n de la tarjeta","image":"Imagen de la tarjeta","buttons":"Opciones de la tarjeta"},"chatcontainer":{"title":"Ventana del chat"},"form":{"header":"Fromulario","inputs":"Campos del formulario","buttons":"Opciones del formulario","defaultError":"Este campo es requerido"},"agent":{"agentChat":"Chat con agente","waitUser":"Seguimos intentando ponerle en contacto con un agente. Por favor, espere en l\xednea."}}')},71:function(e,t,a){e.exports={eva4Config:{token:{keycloak_ur:"keycloak-europe-admin.eva.bot",org_name:"AYTO-MADRID",grant_type:"client_credentials",client_id:"ayto-madrid",client_secret:"BNJeqK5dX2HdkcNFSWIxI0WsQfluWkog"},conversation:{url:{instance:"europe-instance1",orgUUID:"be19031a-8c28-4407-a0b0-a114f03e17b2",envUUID:"b2e31e56-0425-4692-9db2-5ee671b9ad8a",botUUID:"4a7fe88c-65ae-4a59-9293-2b81edb52afc"},headers:{"Content-Type":"application/json","API-KEY":"d5e21644-1293-11ed-8973-4201ac1e010a",CHANNEL:"Webchat",LOCALE:"es-ES",OS:"Windows"}}}}},77:function(e,t,a){}},[[116,1,2]]]);
//# sourceMappingURL=main.17fdac77.chunk.js.map